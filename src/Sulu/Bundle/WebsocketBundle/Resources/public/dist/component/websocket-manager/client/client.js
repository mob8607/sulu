define(["jquery"],function(a){var b=function(b,c){this.app=b,this.type="NONE",this._onMessage=a.Deferred(),this.handlers={},c||(c=this.generateUuid()),this.id=c};return b.TYPE_WEBSOCKET="WEBSOCKET",b.TYPE_AJAX="AJAX",b.prototype.generateMessage=function(a,b,c){return JSON.stringify({handler:a,message:b,options:c})},b.prototype.send=function(a,b){return this.doSend(a,b)},b.prototype.getType=function(){return this.type},b.prototype.addHandler=function(b,c){this.handlers[b]||(this.handlers[b]=a.Deferred()),this.handlers[b].progress(c)},b.prototype.onMessage=function(a){this._onMessage.progress(a)},b.prototype.generateUuid=function(){function a(a){var b=(Math.random().toString(16)+"000000000").substr(2,8);return a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b}return a()+a(!0)+a(!0)+a()},b});