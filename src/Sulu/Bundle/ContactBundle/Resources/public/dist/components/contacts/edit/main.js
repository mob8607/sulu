define(["services/sulucontact/contact-manager","services/sulucontact/contact-router"],function(a,b){"use strict";return{collaboration:function(){return this.options.id?{id:this.options.id,type:"contact"}:void 0},header:function(){var a={title:function(){return this.data.fullName}.bind(this),tabs:{url:"/admin/content-navigations?alias=contact",options:{disablerToggler:"husky.toggler.sulu-toolbar",data:function(){return this.sandbox.util.extend(!1,{},this.data)}.bind(this)},componentOptions:{values:this.data}},toolbar:{buttons:{save:{parent:"saveWithOptions"}}}};return this.options.id&&(a.toolbar.buttons["delete"]={},a.toolbar.buttons.disabler={parent:"toggler",options:{title:"public.locked",hidden:!0}},a.toolbar.buttons.enable={options:{title:"user.enable",hidden:!0}}),a},loadComponentData:function(){var b=this.sandbox.data.deferred();return a.loadOrNew(this.options.id).then(function(a){b.resolve(a)}),b},initialize:function(){this.bindCustomEvents()},bindCustomEvents:function(){this.sandbox.on("sulu.header.back",b.toList),this.sandbox.on("sulu.toolbar.delete",this.deleteContact.bind(this)),this.sandbox.on("sulu.tab.dirty",this.enableSave.bind(this)),this.sandbox.on("sulu.router.navigate",this.disableSave.bind(this)),this.sandbox.on("sulu.toolbar.save",this.save.bind(this)),this.sandbox.on("sulu.tab.saving",this.loadingSave.bind(this)),this.sandbox.on("sulu.tab.data-changed",this.changeData.bind(this))},deleteContact:function(){this.sandbox.sulu.showDeleteDialog(function(c){c&&a["delete"](this.options.id).then(function(){b.toList()}.bind(this))}.bind(this))},changeData:function(a){this.data=a},saveTab:function(){var a=$.Deferred();return this.sandbox.once("sulu.tab.saved",function(b,c){c&&this.changeData(b),a.resolve(b)}.bind(this)),this.sandbox.emit("sulu.tab.save"),a},save:function(a){this.saveTab().then(function(b){this.afterSave(a,b)}.bind(this))},loadingSave:function(){this.sandbox.emit("sulu.header.toolbar.item.loading","save")},enableSave:function(){this.sandbox.emit("sulu.header.toolbar.item.enable","save",!1)},disableSave:function(){this.sandbox.emit("sulu.header.toolbar.item.disable","save",!1)},afterSave:function(a,c){this.sandbox.emit("sulu.header.toolbar.item.disable","save",!0),this.sandbox.emit("sulu.header.saved",c),"back"===a?b.toList():"new"===a?b.toAdd():this.options.id||b.toEdit(c.id)}}});